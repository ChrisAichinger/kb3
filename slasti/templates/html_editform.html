## -*- coding: utf-8 -*-
<%! import time %>
<%
    title = ""
    url = ""
    tags = ""
    note = ""
    if mark:
        title = mark.title or ""
        url = mark.url or ""
        tags = ' '.join(mark.tags or [])
        note = mark.note or ""
%>
<%include file="html_header.html"/>
<%include file="html_body_top.html"/>
<script src="${s_baseurl}/edit.js" type="text/javascript"></script>
<form action="${s_action_edit}" method="POST" name="editform">
 <table>
 <tr>
  <td>Title
  <td>
  <input name="title" type="text" size=80 maxlength=1024 id="edt_title"
           value="${title | filter.attr}" />
    % if not mark:
    <input name="preload" value="Preload" type="button" id="btn_preload"
    onclick="preload_title('${s_userurl}/fetchtitle',
                           'edt_title', 'btn_preload');" />
    % endif
 </tr><tr>
  <td>URL
  <td><input name="href" type="text" size=95 maxlength=1024
       value="${url | filter.attr}"/>
 </tr><tr>
  <td>tags
  <td><input name="tags" type="text" size=95 maxlength=1024
       value="${tags | filter.attr}"/>
 </tr><tr>
  <td>Extra
  <td><textarea name="extra" type="text"
                cols=95 rows=4>${note | filter.html}</textarea>
 </tr><tr>
  <td colspan=2><input name=action type=submit value="Save" />
 </tr></table>
</form>

% if s_action_delete:
<p>or</p>
<form action="${s_action_delete}" method="POST">
  <input name=mark type=hidden value="${mark.key_str()}" />
  <input name=action type=submit value="Delete" />
  (There is no undo.)
</form>
% endif

% if similar_marks:
    <p>
    Similar bookmarks:
    <ul>
    % for smark in similar_marks:
    <li>
        ${time.strftime('%Y-%m-%d', time.gmtime(smark.time))}
        [<a href="${s_username}/mark.${smark.key_str()}">&#9734;</a>]
        <a href="${smark.url | filter.attr}"
            >${smark.title or smark.url | filter.html}</a>
    </li>
    % endfor
    </ul>
    </p>
% endif
</body>
</html>
